<!DOCTYPE html>
<html>
  <head>
    <title>Multiple Logistic (Date_Fruit_Datasets.csv)</title>
    <meta charset="UTF-8" />
  </head>
  <body>
    <pre>
# --- Logistic Regression on Date Fruit Dataset (Multiclass Classification) ---

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix
from google.colab import drive

# 1Ô∏è‚É£ Mount Google Drive
drive.mount('/content/drive')

# 2Ô∏è‚É£ Load the Dataset
file_path = "/content/drive/My Drive/Datasets/logistic/Date_Fruit_Datasets.csv"
df = pd.read_csv(file_path)
print("‚úÖ Data loaded successfully.")
print("\nüîπ Columns available in dataset:")
print(df.columns.tolist())

# 3Ô∏è‚É£ Data Cleaning
df.dropna(inplace=True)
print(f"\n‚úÖ After cleaning: {df.shape[0]} rows and {df.shape[1]} columns.")

# 4Ô∏è‚É£ Identify Features and Target
# üëâ Adjust these based on actual column names printed above
# Common column names in Date_Fruit_Datasets are like:
# ['AREA', 'PERIMETER', 'MAJOR_AXIS', 'MINOR_AXIS', 'ECCENTRICITY', 'Class']

# Try to use flexible matching (handles upper/lowercase variations)
columns_lower = [c.lower() for c in df.columns]

# Helper to find best matches
def find_col(name):
    for col in df.columns:
        if name.lower() in col.lower():
            return col
    return None

area_col = find_col("area")
peri_col = find_col("perimeter")
major_col = find_col("major")

features = [area_col, peri_col, major_col]
target = find_col("class")

# Safety check
if None in features or target is None:
    raise ValueError(f"‚ùå Could not find one or more required columns. Found features={features}, target={target}")

print(f"\n‚úÖ Using features: {features}")
print(f"‚úÖ Using target: {target}")

X = df[features]
y = df[target]

# 5Ô∏è‚É£ Split Data
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

# 6Ô∏è‚É£ Feature Scaling
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# 7Ô∏è‚É£ Train Logistic Regression Model (Multiclass)
model = LogisticRegression(multi_class='multinomial', solver='lbfgs', random_state=42, max_iter=1000)
model.fit(X_train_scaled, y_train)

# 8Ô∏è‚É£ Evaluate Model
y_pred = model.predict(X_test_scaled)
accuracy = accuracy_score(y_test, y_pred)

print(f"\nüéØ Model Accuracy: {accuracy:.4f}")
print("\nüìä Confusion Matrix:")
print(confusion_matrix(y_test, y_pred))
print("\nüìà Classification Report:")
print(classification_report(y_test, y_pred))

</pre
    >
  </body>
</html>
